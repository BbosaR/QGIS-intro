[
["index.html", "QGIS for Transport Research: an introduction Preface What is this resource? Part 1: an introduction to GIS Part 2: QGIS for transport Why learn GIS?", " QGIS for Transport Research: an introduction Robin Lovelace Malcolm Morgan Ian Philips 2020-01-18 Preface What is this resource? This resource is in two parts and accompanies teaching delivered on MSc degrees in transport to students at the Institute for Transport Studies (ITS) at the University of Leeds. Part 1: an introduction to GIS This workbook contains information about getting started using Geographical Information Systems (GIS) using the QGIS application. It assumes no prior knowledge of either GIS concepts or experience of using GIS applications. Part 1 Pre-requisites If you are an ITS student This part has no pre-requisites: It is aimed at students little or no experience of using any GIS software and those who are new to the open source software called QGIS. The materials accompany a semester 1 face-to-face workshop for ITS Students, but, they are designed for students to work through at their own pace. This means that if you do not attend the workshop, you can still make use of the resources. If you are not an ITS student or you are not at the face to face workshop Unless you are using a Univerist of leeds cluster computer, this course assumes that you have access to a working installation of QGIS 3 and an internet connection. We will explain how to download the data needed for the practicals in Chapter 3. Part 2: QGIS for transport Part 2 is about key QGIS skills for transport students studying Sustainable Spatial Planning and Analysis. Sustainable Spatial Planning and Analysis is a second semester MSc module taught at ITS. Part 2 covers key skills required by students on this course. These materials accompany a face to face workshop delivered as part of the module. Part 2 Pre-requisites The pre-requisite for this part is to have worked through part 1. Why learn GIS? We are teaching transport GIS because transport is an inherently geographic phenomena. All transport involves movement from one place on Earth to another, whether its by walking, flying or telecommunications. Those movements and flows impact and are impacted upon by the people and places along the routes. Geographic Information Systems (GIS) therefore have great potential to assist transport researchers and practitioners. We are teaching QGIS. Which is free and open source. "],
["introduction-gis-ideas-and-concepts.html", "1 Introduction: GIS ideas and concepts 1.1 What is GIS? 1.2 Key ideas: 1.3 Free and Open Source Software. 1.4 Projections and coordinate systems", " 1 Introduction: GIS ideas and concepts 1.0.1 Learning Objectives: Gain a basic understanding of what a GIS is and its relevance to transport studies Know what some of the key data types and file formats Import pre-cleaned vector data into QGIS and navigate basic QGIS features Select a subset of the data Make a map showing point, line and polygon features and export it. Understand the key cartographic elements that must be present to allow interpretation of a map 1.0.2 What is included in Part 1? GIS ideas and concepts - we very briefly introduce some key GIS concepts and ideas. Opening QGIS and essential features - We then explain what the main components of QGIS are, explain how to set up a project and save work and what some of the most useful buttons do Downloading and loading data - we show you how to get some data we have prepared for the workshop and load it into QGIS Style and select features - change the way features look on the screen Making maps - Make a map which you can export and include in a document 1.1 What is GIS? 1.2 Key ideas: GIS is an abbreviation. Sometimes it is used to mean Geographic Information System and sometimes it is used to mean Geographic Information Science. A more formal definition of a Geographical Information System is: A powerful set of tools for collecting, storing, retrieving at will, transforming and &gt;displaying spatial data from the real world (Burrough, 1986) The emphasis here is on pieces of software like QGIS. In practical terms, a Geographic Information System is a database to store data, a calculator which can manipulate and analyse data, a visualisation window to show results. GIS software like QGIS also has a Graphical User Interface (GUI) with menus and buttons which lets the user ‘do stuff’. In Part 1, we are concentrating on learning how to use the basic features of the Geographic Information System application called QGIS. A more formal definition of Geographical Information Science is given by Goodchild, (1992) who argues that Geographical Information Science involves research that investigates spatial data acquisition, spatial statistics, modelling and theories of spatial data, development of analytical tools and consideration of the management and ethics of working with spatial data. As an introduction, the Wikipedia entry contains a lot of information. In the further reading section, there are references to crucial GIS textbooks for a more formal treatment of key GIS concepts. https://en.wikipedia.org/wiki/Geographic_information_science GIS in both of the systems and science contexts described above is vital for anyone studying transport because it is an inherently spatial topic of study. Data used in the study of transport can be visualised and analysed using GIS. Learning how to use GIS software like QGIS is a handy skill in its own right. It is also an advantageous start point for people wanting to learn and apply GIScience. There are other terms you may come across, including “spatial data analytics”. The emphasis here is on a branch of science at the nexus of statistics, computer science and quantitative geography. You may also come across the term “geo-computation”. Geocomputation is associated with computational methods that have been customised to address the unique characteristics of spatial data ( https://dx.doi.org/10.4135/9780857024442.d64). There are technical academic differences between these terms, but in practice, they get used interchangeably. This range of terms might sound confusing, but they are all related. 1.3 Free and Open Source Software. We are using QGIS software which is free to download and use. The university has a licence for commercial GIS software (e.g. ArcGIS), but we are aware that not all students will have access to commercial software after completing the course. QGIS is becoming popular with many organisations. For more information about FOSS see: https://en.wikipedia.org/wiki/Free_and_open-source_software 1.3.1 Vector data Vector data represents the features of the world as either ‘points’ ‘lines’ or ‘areas’ (also called polygons). Each type of feature is displayed in the GIS as a distinct layer. A layer will only contain either points, or lines, or polygons. It is also good practice to have different layers for different types of line features. For example, it is good to have a layer for roads and another for rivers. Maps can be made of several layers of vector data as seen here: https://upload.wikimedia.org/wikipedia/commons/3/3b/USGS_The_National_Map.jpg 1.3.2 Raster data: ‘In its simplest form, a raster consists of a matrix of cells (or pixels) organised into rows and columns (or a grid) where each cell contains a value representing information, such as temperature. Rasters are digital aerial photographs, imagery from satellites, digital pictures, or even scanned maps’. ( webhelp.esri.com/arcgisdesktop/9.2/index.cfm?TopicName=What_is_raster_data%3F) (source: http://support.esri.com/other-resources/gis-dictionary/term/raster) 1.3.3 Network data A network dataset takes a line dataset and defines its topology explicitly. Defining topology means having data tables that explicitly lists which lines are connected and at which nodes. In its simplest form, this means recording the connections between the ends of different lines. Data in this form is often called a graph as the branch of mathematics that deals with networks is called graph theory. 1.3.4 Data formats – how is data stored in a GIS and on your computer. QGIS can handle a vast number of different data formats. In today’s exercises, we will start by using use a file format called “Shapefile” as it is a prevalent type of vector GIS data format. The Shapefile format was developed by ESRI who make the commercial GIS software ArcGIS (ArcGIS is also available on university machine). The Shapefile format appears on your computer as several files which may seem a little confusing. Each file contains a different type of information that the GIS needs to represent the spatial data. NB. If you ever want to share a shapefile with someone, you have to send the whole group of files. Figure 1.1: A shapefile is a group of files. It is a common file format While shapefiles are still used, they have many limitations. Resulting in a campaign against shapefiles. There are other types of GIS files, including GeoJSON and geo-package formats. Data is stored in GIS as database tables. GIS data can be stored and shared in a very large number of ways. (For an introduction see https://en.wikipedia.org/wiki/GIS_file_formats as well as the further reading in the appendix. 1.4 Projections and coordinate systems The world is not flat, but computer computer screens are. Coordinate systems, also known as coordinate reference systems (CRS), allow GIS to represent the curved surface of the Earth on a flat screen or page. Figure 1.2: How do we fit a curving earth onto a flat piece of paper Image source comes from this presentation: http://mjfoster83.github.io/projections/#/5 . The projection is a mathematical formula explaining how places in the real world which are on a near spherical globe can be represented on a flat map. More information on projections and coordinate systems can be found in GIS test books. Coordinate Reference Systems (CRS) refer to different ways of defining the X and Y coordinates used in different projections. Broadly they fall into two categories: Geographical Coordinate Systems: use latitude and longitude to represent any place on the Earth Projected Coordinate Systems: use distances from an origin point to represent a small part of the Earth, e.g. a country. The advantage of a projects CRS is that it is easier to calculate properties such as distance and area as coordinates are in metres. You can find a catalogue of different CRSs at http://spatialreference.org/ CRSs are often referred to by the EPSG number. The European Petroleum Survey Group publish a database of different coordinate systems. Two useful projections to commit to memory are: 4326 - the World Geodetic System 1984 which is a widely used geographical coordinate system, used in GPS datasets and the .geojson file format, for example. 27700 - the British National Grid "],
["working-with-qgis.html", "2 Working with QGIS 2.1 Opening QGIS 2.2 Key QGIS components 2.3 QGIS projects 2.4 Setting a coordinate reference system (CRS) 2.5 Panning and Zooming 2.6 Summary", " 2 Working with QGIS Before importing data (covered in Chapter 3) it is worth getting to know QGIS, in terms of its main components, how to get help, and how it helps you organise your work into projects. This chapter describes some of QGIS’s key elements. 2.1 Opening QGIS Probably the quickest way to open QGIS on your computer press ‘Windows button’ on your keyboard and type ‘qgis’ (see Figure 2.1). Figure 2.1: Starting QGIS Select ‘QGIS Desktop’ from the list. If you have multiple versions, choose the latest version. You should see a new window appear that contains the main features of the QGIS program (see Figure 2.2). 2.2 Key QGIS components These include the following main components, numbered from 1:5 in the figure and the bullet points below (source: adapted from the QGIS Manual): Menu Bar: like most GUI-based programs you can control key aspects of QGIS and execute key commands, like saving your project and loading new datasets, by clicking Project or Layer. Note: shortcuts to access these menus from the keyboard are Alt+J and Alt+L, respectively. Toolbars: these are small icons located towards the top and left-hand side of Figure 2.2. In addition to options available from the Menu Bar, these icons provide tools for interacting with the map such as Pan (the hand symbol) and Zoom (the + and - signs). Panels: Panels are interactive elements that show information on particular aspects of the project. A view of files in the Browser Panel and the Layers Panel are shown in Figure 2.2. Map View: this is where the geographic data is displayed in an interactive map for interactive visualisation. Status Bar: this small but important element at the bottom of QGIS shows details about the current status of the Map View, such as the Coordinate Reference System (CRS), in this case, EPSG:3857 and scale. NB. GUI stands for Graphical User Interface. Any programme which wou interact with using menus and buttons has a GUI. Examples are Excel and QGIS. Figure 2.2: QGIS main user interface features 2.3 QGIS projects Projects are the way that QGIS saves your work. Make sure you save your QGIS work in projects. To do this, click on the Project menu and select Save (or Save As), as shown in Figure 2.3 and select a folder that will contain your project. Give your project a sensible name, like ‘learning-qgis’. Figure 2.3: The project menu Projects don’t contain any data themselves but do contain information such as the current map view, links to data, and instructions on how data should be presented. Projects are an easy way to keep your work organised and allows you to stop and come back to work at a later date. They also allow you to set the co-ordinate reference system. 2.4 Setting a coordinate reference system (CRS) To set a coordinate system click on Project &gt; Properties (or use the shortcut Ctrl + Shift + P) The box shown in Figure 2.4 should appear. This allows you to set up the CRS to 27700. Figure 2.4: Project menu, project properties, set Coordinate ReferenceSystsm 27700 Type 27700 into the Filter box. 27700 refers to the “OSGB 1936 British National Grid”. This is a projected coordinate system for the UK. (there is a brief explanation of co-ordinate systems in Chapter 1). Click apply before clicking OK. If it has worked the bottom right of your screen will say “EPSG:27700” Save the project and give it a suitable name such as “QGIS_Intro” You can create, load, save and ‘save as’ projects using the buttons shown in Figure 2.5 or using the options in the Project menu. QGIS project files have the extension.qgz Figure 2.5: New Project, Open Project, Save Project, Save Project As buttons A common GIS mistake is to send someone a project file and expect that they can look at your maps and data. But, this does not work, because project files do not contain data. If you want to send someone a QGIS project to work on or look at, then you need to send them the project file and any data which you have loaded into the project. (We will show how to load data in the next chapter). 2.5 Panning and Zooming You can naviagate around the map using the mouse or the buttons in the toolbar. Figure 2.6: Navigation buttons: Pan Map, Pan to Selection, Zoom In, Zoom Out, Zoom to Native Resolution, Zoom Full, Zoom to Selection 2.6 Summary This section introduced QGIS and its main components. Before moving on to the next section, in which we will import data into QGIS, ensure that you have: Opened QGIS and created and named a project, setting the coordinate reference system and saving it in an appropriate place on your computer. "],
["data.html", "3 Downloading and loading data 3.1 Downloading data 3.2 Importing spatial data 3.3 Importing a CSV or text file 3.4 Loading basemaps 3.5 Summary", " 3 Downloading and loading data 3.1 Downloading data A vital skill for doing using GIS skills to solve real-world problems is finding, downloading and importing data. Often, the first stage in the data downloading/loading process is to find the data online. You will need several data sets to add to your QGIS project. First you will need to download the data. Click on the link below or type in the following URL into your internet browser: github.com/ITSLeeds/QGIS-into/releases. On that page you will see several links. For the exercises in part 1 you will need this one: qgisdata.zip. Download and unzip the files into an appropriate place on your computer, in the folder where your QGIS project lives. Once downloaded, right click on the zipped folder that has been downloaded to your computer and select “extract all”. 3.2 Importing spatial data To load a spatial data file, click on the Data Source Manager button in the top left corner of QGIS (see Figure 3.1). Figure 3.1: The Data Source Manager icon We will first load a polygon layer. Open the Data Source Manager and select “Vector”. Next press the button with 3 dots, which is below and right of where it says source. Next navigate to the file by finding the folder “qgisdata”. Inside this is another folder “Access_DeprivationLeeds” Add the data: “Access_DeprivationLeeds.shp” Click “Add” then “Close”. Note the data manager does not close automatically after adding a file to your project, this is to allow you to add multiple files at once. Figure 3.2: The Data Source Manager - Vector The result should look something like the map displayed in Figure 3.3 (but the colour might be different). Figure 3.3: The map after the file ‘Access_DeprivationLeeds.shp’ has been imported. Next add the cycle_routes layer (note this is a line layer). Follow the steps above, but note that you may need to ‘navigate up the file tree’ (which means go up a folder level to ‘IntroQGISdata2019’) then you will be able to click on the folder ‘cycle_routes’. 3.3 Importing a CSV or text file 3.3.1 CSV with spatial data We have already loaded polygon and line data. Now we will add point data Sometimes you have data that contains spatial information but is not in a spatial data format. A common example is to have a CSV file with latitude and longitude columns. CSV is a common format for storing data and can be opened by lots of different software, including Microsoft Excel. We will plot the location of vehicles collisions in Leeds. Use the ‘stats19.csv’ example file. Open the Data Source Manager and select “Delimited Text” then specify the “File Name” and location, or use the … to navigate to the file. Under the “Geometry definition” select “Point coordinates” and set the “X field” to “longitude” and the “Y field” to “latitude”. Set the “Geometry CRS” to “EPSG: 4326 – WGS 84”. Note here we are explicitly telling QGIS the CRS of the data. Click “Add” then “Close”. Figure 3.4: The Data Source Manager - Delimited Text After importing the ‘stats19’ data, using menus shown in Figure 3.4, you should see points on the map, representing where crashes in Leeds took place in 2017. If you do not see dots on the map, re-read this section and have another go. If you do, like in Figure 3.5, congratuations, you can now load data into QGIS! Figure 3.5: Summary of the data loaded in this Chapter, note the name of the datasets in the Layers menu. 3.4 Loading basemaps You can add a “basemap” as follows: Click on the ‘XYZ Tiles’ option in the Browser Panel. Options should include Google and OpenStreetMap. Clicking on one of these will add a new layer, which can be seen in the Layers menu. The basemap now obscures the other layers you have added. Go to the layers panel and drag the basemap to the bottom of the list of layers. The Basemap will now appear below the other layers. Now save your work. Save your work regularly. 3.5 Summary Before moving on to the next chapter make sure you have. Downloaded the example data Imported the files to QGIS Added a basemap Bonus Exercises Read about the disadvantages of shapefile and some of the alteratives http://switchfromshapefile.org/ In the course data folder, there is a copy of the “Access_DeprivationLeeds” file in Geopackage format. Have a go at loading this layer into QGIS. the polygons may be a different colour to the shapefile, but it should cover the same area. "],
["style-and-select-features.html", "4 Style and select features 4.1 Identify Features 4.2 The Attribute Table 4.3 Symbology 4.4 Summary", " 4 Style and select features 4.1 Identify Features You now have several layers on your map. You can turn layers on and off by clicking the tick box to the left of the layer in the layer tab. You can also change the order of layers by dragging layers up and down the layer panel. In the layers panel, Single left click where it says “Acess_deprivationLeeds”. This will allow us to identify features from that layer. Press the ‘Identify features button’/. It allows you to interrogate features on the map by clicking on them (see Figure 4.1). Figure 4.1: Identify Features Button Clicking on a map feature brings up a panel with more information about that feature. (see Figure 4.2). The names which appear in the panel might not make sense. It is good practice when creating GIS data to make a note of what each column name means, where the data comes from and provide ‘metadata’. This list of “basic metadata” tells you what each column of data is (data columns also get called data fields). Access_DeprivationLeeds LSOA11C LSOA code emp2013 = travel time (minutes) to nearest employment centre gpp2013 = travel time (minutes) to nearest doctor 2013 hsp2013 = travel time (minutes) to nearest hospital 2013 twn2013 = travel time (minutes) to nearest town centre 2013 IMDDecl = Index of multiple Deprivation decile pop = population pop_dens = population density per hectare Figure 4.2: Identify Features Pannel 4.2 The Attribute Table As well as mapping shapes, QGIS stores information about each feature called “attributes” in an attribute table. To open the attribute table, Go to the layer panel and right click on the layer AccessvsDep_Leeds layer Click “open attribute table”. The attribute table looks rather like a spreadsheet, the columns (data fields) are labeled as per the metadata above. 4.3 Symbology So far you have loaded layers to show the shapes and locations of features. You can also change the appearance of layers to communicate additional information about the attributes of particular features in particular places. This is called symbology. Setting symbology, colour and transparency of a polygon layer Double click on the Access_DeprivationLeeds layer, the ‘Layer properties’ dialog box appears We are going to display deprivation deciles as categories. Click the dropdown menu where it says ‘single symbol’. Select ‘categorised’ from the classification drop down menu shown below because the deciles are Ordinal data. (You would choose ‘Graduated’ if you were visualising a continuous variable such as population density) Select ‘IMDDecl’ from the column drop down list. Select ‘Blues’ from the Color Ramp drop down list Press the ‘Classify’ button Press the Colour ramp dropdown list again. This time select ‘invert colour ramp’ (1 is most deprived 10 is least deprived) Click the ‘Layer Rendering’ arrow and Set the opacity slider to 50%. Click apply and then OK. Figure 4.3: Setting the symbology of a polygon layer Setting symbology of a line layer with a single symbol Double click on the layer name, select symbology and experiment with the line colour and thickness to get something that shows up well. Setting symbology of a point layer Another way to open the layer properties dialog box is as follows: In the layers panel right click on “stats19” and select “properties”, in the menu on the left select “Symbology” Figure 4.4: Symbology Menu used to categorise a point layer For the type of Symbology select “Categorised”, the column “accident_severity”, then chose a colour ramp from the drop-down menu. Then click “Classify”. This will add all the different possible values from the data and assign each a unique colour. Click OK to return to the map. Figure 4.5: Road collisons categoried by severity Finally Using the opacity slider (in the symbology dialog box) and re-ordering the layers (by dragging them in the layer panel), arrange the mulitple layers clearly. You may also want to zoom in or our a little to ensure you can see all the map features. Be sure to save your work regularly 4.4 Summary Before moving onto the next chapter make sure you have. set the symbology of the points lines and polygon data. Saved your work Bonus Exercises Experiment using different columns and types of symbology Hint: Think about how different types of symbology are appropriate to different types of data (categorical, discreet, continuous). Can you discover any interesting patterns in the data? when plotting a continuous variable e.g. population density, experimnet setting the mode as ‘Equal Interval, ’Quantile’ and ‘Natural Breaks’. How does your choice of breakpoints affect the presentation of the data? "],
["create-and-edit-transport-data.html", "5 Create and edit (transport) data", " 5 Create and edit (transport) data Sometimes it is useful to create your own geographic data, for example to represent new transport infrastructure. This short chapter, based on Section 6.1 in the QGIS manual, demonstrates how to create a new layer. In it we will create an object representing Leeds Rail Station. First, ensure that the Digitising Toolbar is enabled (click on View| Toolbars | Digitizing if it is not). You should see buttons like those shown in Figure 5.1. Figure 5.1: Selecting a new GeoPackage layer from QGIS’s top ribbon menu. Click on “New GeoPackage Layer” and you should see another box. Fill the fields in the box according to the text shown in Figure 5.2 (note we’re creating a layer with geometry type Point) and click OK to create the layer. Figure 5.2: Popup box to add new GeoPackage layer, with text added for Leeds Rail Station. Next, click the pencil icon (see 5.1 below the Plugins menu) and then click on the Add Point Feature just to the right of the pencil. When you have placed the point somewhere, click on the pencil to stop editing and save the resulting layer. It should something like that shown in Figure 5.3. Not impressed with how the map looks? Do not worry. Styling features is the topic of the next chapter! Figure 5.3: Screenshot of the map after a new layer has been added. "],
["making-maps.html", "6 Making maps 6.1 Creating a print layout 6.2 Basic but essential cartographic elements that allow interpretation of your map. 6.3 Saving &amp; Exporting your map 6.4 Summary", " 6 Making maps 6.1 Creating a print layout While it is useful to view maps within QGIS it is usually necessary to export the maps for printing or to be included in a report. From the project menu select “New Print Layout”, you will be asked to give your new layout a name. You will then see a blank page. Figure 6.1: The print layout window, highlighting the add new map button Use the “Add new map button” to draw a box where you wish your map to be on the page. Your map will appear within the box automatically. You can pan and zoom within the map using the “Move Item Content” button Figure 6.2: Move Item content button To the right of the print layout you will see a panel. In this you can set the properties of the different elements on your map. For example you can change the scale of your map. Figure 6.3: Setting the scale of the map in the print layout 6.2 Basic but essential cartographic elements that allow interpretation of your map. The QGIS print composer lets you set many aspects of how each feature looks on the page.This takes practice, but it is possible to produce very striking maps which convey important information. Communicating the insights drawn from spatial data to policy stakeholders is an important aspect of transport research and planning so it is worth the effort. Add a map title Every map needs either a title or a caption to explain to the reader what is being shown. Figure 6.4: Add a Map title in the print layout Add a title. Press the ‘add new label’ button on the left of the print layout. If you run the mouse ofer the buttons their names will be displayed on the screen. Click on the page, above the map, and a label will appear at the top of the map. Resize it and place it in the top centre of the page. It can be resized and moved in the same way that you resized and moved the map. As you move the title, you’ll notice that guidelines appear to help you position the title in the centre of the page. However, there is also a tool to help position the title relative to the map (not the page): Click the map to select it. Hold down ‘shift’ on your keyboard and click on the label so that both the map and the label are selected. Look for the Align button on the tool bar near the top of the print layout. Figure 6.5: The Align button Add a scale bar Press the scale bar button on the left of the print layout. Insert a scale bar using the scale bar button shown below and changing the settings using the settings in the scale item properties. (#fig:scale_bar_button)The scale bar button On the right of the screen click the item properties tab. You can change the map units to metres or miles if you with by pressing the dropdown menu in the Units area. You can change the look of the scale bar by changing the number of segments. You can also click the triangle next to fonts and colours to further change the appearance of the scale bar. Figure 6.6: The Align button Add a legend The map reader also needs to be able to see what various things on the map actually mean. In some cases, like the place names, this is quite obvious. In other cases, it’s more difficult to guess. Let’s add a new legend. Click on the legend button Click on the page to place the legend, and move it to where you want it: It may initially have more entries than you want. Go to the legend box on the right of the screen, un-check the auto update box. Click on ‘OpenStreetMap’ if you have a basemap, and then press the red minus button below the list. Repeat this for any other layers that you don’t want in the legend. Figure 6.7: Add a map legend. Use the legend button and the legend items box 6.3 Saving &amp; Exporting your map You can save a map layout for later use using the save button on the main toolbar or using “Save project” in the “layout” menu. You can export your image in one of three formats. Export as Image - A range of different formats including JPEG, PNG, GIF, TIF etc Export as PDF - A PDF document Export as SVG - A Scalable Vector Graphics image All of these options and the option to print your map directly are in the “layout” menu. 6.4 Summary This chapter has briefly introduced the print layout window. Before moving onto the next chapter make sure you have. Produced your own print layout including a map, title, scale bar, and legend. Bonus Exercises Experiment using different tools in the print layout window. Can you find out how to: Pan and zoom the map to a specific area of interest Customise the title font and appearance Add an arrow pointing to your location Add the ITS logo to your print layout "],
["advanced-features-in-qgis.html", "7 Advanced features in QGIS 7.1 Learning Objectives:", " 7 Advanced features in QGIS QGIS is a powerful tool and it can be used to tackle a wide range of transport problems that have geographic components. In this second part of the booklet we will go beyond the foundations of read-in and visualising data covered in the previous chapter and move on to geographic analysis. 7.1 Learning Objectives: Aim: Introduce SSPA students to principal vector and raster GIS skills that will be used in the subsequent practicals and assessment Learning objectives: Process key GIS data types; vector and raster. Carry out common vector geoprocessing tasks such as joining, selection, buffering and point in polygon operations. Carry out a raster processing activity. Visualise transport flows as part of an accessibility analysis. Understand that more complex GIS operations can be achieved in QGIS by using “plug-ins”. Be aware of a range openly available spatial data available to and useful to sustainable transport planning. –&gt; "],
["processing-vector-data.html", "8 Processing vector data 8.1 Reprojecting Data 8.2 Joining Data 8.3 Points in Polygons 8.4 Summary", " 8 Processing vector data We saw in Chapter 5 how to style and select features of interest from layers loaded into QGIS. In this section, we will learn how to process data. That means creating new data from existing data. 8.1 Reprojecting Data Our two spatial datasets have different coordinate systems. This can make it challenging to make connections between the datasets. So we will reproject the stats19 data to the British National Grid. In the vector, menu select Data management Tools, Reproject Layer. Figure 8.1: Reproject Menu Then select the British National Grid as the target CRS. If it is not listed in the drop-down menu, then use the button to the right to open the Coordinate Reference System menu. You can use the search box to search for a CRS by name or its EPSG code. Figure 8.2: Reproject Menu Coordinate Reference System 8.2 Joining Data Joining data allows you to link two separate datasets together by something they have in common. There are two types of join. Attribute joins (often just called joins) link two datasets by a common attribute such as an ID number. Spatial joins link datasets by a shared location. In this next section, we will use a series of joins to find the area of Leeds with the highest rate of road collisions. 8.2.1 Attribute Joins We will join the population data onto the LSOA boundaries. Find “leeds_lsoa” in the Layers panel and right-click to bring up the context menu. Click on Properties Select Joins from the options on the left. Click the green + button to open the Add Vector Join window. Select the following options: Join layer: population Join field: area Target field: lsoa11cd Click OK, Click OK again Figure 8.3: The Add Vector Join window Use the “Identify features” tool to see that each LSOA now has a population value. 8.2.2 Spatial Joins We will assign an LSOA ID number to each road collision by doing a spatial join. In the Vector Menu, select Data Management Tools, Select Attributes by location, as shown in 8.4. Figure 8.4: Join Attributes by Location For the Input Layer select “stats19” and for the output later select “leeds_lsoa”. For join type select “Create separate feature of each located feature”. Then click “Run in Background”, as shown in 8.5. Figure 8.5: Join Attributes by Location Window Once the process has completed a new layer will have been added to the map called “joined Layer” you can use the “Identify Features” tool to see that each point in the stas19 data now has the new field lsoa11cd containing the LSOA id number for each point in the stats19 data. Manually check a few random points using the “Identify Features” tool to ensure the process has worked correctly. Figure 8.6: Join Results 8.3 Points in Polygons The final step for this chapter will be to count the number of road crash casualties in each LSOA. In the Vector Menu, select Analysis Tools, Count Points in Polygons. Figure 8.7: Points in Polygons Tool For the Polygons choose your LSOA areas and the points the stats19 data. USe the number of casualties as a weighting field, and give the “count field name” an appropriate name. A new layer will be created with the number of casualties for each LSOA. Use symbology to visualise the most dangerous areas of Leeds. Figure 8.8: Number of road crash casualties in Leeds 8.4 Summary Before moving onto the next chapter, make sure you have. Reprojected the stats19 data to the British National Grid Done an attribute join of the population data to the LSOA areas Done a spatial join of the LSOA areas to the stats19 points Counted the number of casualties in each LSOA Bonus Exercises Can you use symbology to show the population of each LSOA? Can you use symbology to indicate the number of casualties in each LSOA? "],
["raster-data-1.html", "9 Raster Data 9.1 What is the difference between raster and vector data. 9.2 Download Sample Data 9.3 Adding raster data to the map 9.4 Normalized difference vegetation index 9.5 Linking Raster and vector data 9.6 Summary", " 9 Raster Data So far, we have only used Vector data with QGIS; this chapter will introduce raster data. 9.1 What is the difference between raster and vector data. Vector data is made up of points, lines, and polygons with attributes. This data structure makes it well suited to many GIS purposes. For example, we have already seen that the boundaries of an LSOA can be recorded as a polygon and that each polygon can have attributes like the area name, population etc. Raster data is very different. It is essentially an image where each pixel has a value. Rasters are always rectangular and have a fixed resolution (so they become pixilated as you zoom in). A common use of raster data is satellite and aerial photography. These images are made from three overlapping rasters (often called a raster stack or raster brick). The three rasters represent the Red, Blue, Green colour bands which together make up a full-colour image. Raster can have more than three bands; for example, they may be used to represent changes over time or colours beyond human perception such as infra-red or ultraviolet. 9.2 Download Sample Data Download the sample raster data from here: https://github.com/ITSLeeds/QGIS-intro/releases/download/0.01/leeds_cir_compress.tif 9.3 Adding raster data to the map Adding raster data to QGIS is done using the same data manager as vector data, except you must use the raster tab. You will notice that the raster contains an aerial photograph of Leeds, except the colours, appear to be wrong. Figure 9.1: The sample raster data added to the map The colour difference is due to this raster being a colour infrared image. Rather than the usual Red, Green, Blue bands this image has Near Infrared (NI), Red, Green. 9.4 Normalized difference vegetation index You may have noticed that the trees and grass in the raster appear bright red, but most other features appear grey. We shall use the raster to calculate the Normalized difference vegetation index (NDVI) a measure of how much vegetation is within each raster cell. Within the “Raster” menu select “Raster Calculator” the formula for calculating the NVDI is: \\[\\frac{NI - Red}{NI + Red}\\] Enter the formula into the raster calculator notice the use of @ to designate the different bands of the raster layer. Remember to specify where you want the results to be saved. Figure 9.2: The raster calcualtor with the NDVI formula Once the raster calculator is complete, you should have a new raster layer. It will be in greyscale with values between -1 (least vegetated) and 1 most vegetated. You can adjust the symbology to make the vegetated areas clearer. In the figure, three colours are defined 0 (white), 0.2 (light green), 1 (dark green). These colours approximately make trees dark green, grass light green, and all non-vegetation white. Figure 9.3: The NDVI raster with a psudo-colour scheme applied 9.5 Linking Raster and vector data Finally, we will link the NDVI raster back to the LSOA boundaries so that we can have an average vegetation score for each LSOA. In the processing menu select “toolbox”, this opens the processing toolbox panel on the right side. Use the search bar to find the “zonal statistics” tool. Figure 9.4: The Zonal Statistics tool in the processing toolbox Complete the form to get statistics from the NDVI raster for each LSOA. When specifying the statistics to calculate select the mean. Figure 9.5: The Zonal Statistics tool Zonal statistics may take several minutes to run. Once completed, the mean NDVI value will be appended to the attribute table of the LSOA polygons. Adjust the symbology of your LSOA layer to reflect the NDVI scores. Figure 9.6: LSOA areas with average NDVI scores 9.6 Summary This chapter has introduced raster data, the raster calculator, and zonal statistics. Bonus Exercises Consider how you could use the NDVI values to measure access to green spaces. How might you exclude small areas of green space such as gardens, but include large areas such as parks? "],
["accessibility-analysis.html", "10 Accessibility analysis 10.1 Input data 10.2 Identify areas in Leeds with some cycle infrastructure 10.3 Calculate distances to cycle infrastructure 10.4 Calculate cycle infrastructure provision along desire lines 10.5 Plugins 10.6 Advanced exercises (optional) 10.7 Summary", " 10 Accessibility analysis Accessibility is a crucial concept in transport planning. One of the key aims of many transport policies is to make places more accessible to people, whether that’s shops, schools or hospitals. But what does that mean? In this example, we will use QGIS to explore accessibility to cycle infrastructure. Although this is an unusual measure of accessibility, the methods can be modified and extended to explore other types of accessibility, for example, accessibility to schools before and after ‘school agglomeration’, the topic of an academic paper based on a case study in Sao Paulo, Brazil (Moreno-Monroy, Lovelace, and Ramos 2017). 10.1 Input data Building on previous chapters, we will use a case study of Leeds. There are two additional datasets we’ll use for this, saved in the file data_accessibility.zip in the releases section of the tutorial. The input datasets were taken from 2 places: The cycle infrastructure data was taken from the Cycling Infrastructure Prioritisation Tool (CyIPT) The desire lines data were taken from the propensity to cycle tool (see pct.bike/m/?r=west-yorkshire) (Lovelace et al. 2017). Following the guidance in previous chapters, we pre-processed these datasets in 2 ways: Reproject the datasets, so they are in the British National Grid CRS (EPSG:27700) Subset the desire lines so that we only have the top 200 across West Yorkshire Download and unzip the data_accessibility.zip file and load the .gpkg files. As a taster of what we will do, and to check you have the correct input data, the results should look something like the map shown in Figure 10.1. Figure 10.1: Overview of input data for this chapter. 10.2 Identify areas in Leeds with some cycle infrastructure A simple but effective way of comparing two geographic layers, as the first step towards an accessibility indicator, is a spatial selection. We can do this to identify zones that have access to at least some cycle infrastructure: Use the Select by location tool to select only those LSOAs with at least some cycleways in Do this with the following menu options: Vector &gt; Research Tools &gt; Select by Location Save the result as a new layer called, for example, leeds_lsoa_cycleway The result should look like that shown in Figure 10.2. Figure 10.2: Select by Location: results. What proportion of zones have at least some cycle infrastructure, according to this measure? What are the limitations of this approach? List at least 2. 10.3 Calculate distances to cycle infrastructure A slightly more sophisticated measure of accessibility is Euclidean distance. Rather than testing whether or not zones contain cycling infrastructure, resulting in a binary variable, TRUE or FALSE, this simple distance calculation results in a continuous variable in units of metres. To calculate this metric, we will use the ‘Distance to nearest hub’ algorithm in QGIS. To run this algorithm: Open the Processing Toolbox, e.g. by clicking ‘Processing’ from the menu bar and selecting ‘Toolbox’ (pro tip: this can be achieved more quickly by pressing Alt-C and then T to get to the menu without touching the mouse) Search for and select ‘Distance from the nearest hub (points)’ in the Processing Toolbox (see Figure 10.3, left) Select leeds_lsoa as the Source points layer and the existing-cycle-infrastructure as Destination layer in the popup window (see Figure 10.3, left) Figure 10.3: Distance to nearest hub algorithm selection (left) and input parameters in the resulting popup (right). The result is a new point layer, with one point per LSOA zone. Style this new layer based on the Hub distance field it contains and give it an appropriate colour scheme. It should look something like Figure 10.4. Figure 10.4: Demonstration of hub distance calculation Is the distribution of distances to cycle infrastructure as you would expect? Why? List at least two disadvantages of this new accessibility measure and two ways you could improve it using your evolving QGIS skills. Bonus: Use a spatial join to merge the ‘Hub distance’ variable in the new point layer back onto the LSOA zone layer. 10.4 Calculate cycle infrastructure provision along desire lines We have created an acessability measures for zones. WHile zones are widley used for local statics about resident populations (inhabitants), thier static nature tell us little about travel patterns. A more appropriate level of geographic analysis for transport planning is often the desire line; a one-way trip between an origin and a destination (Lovelace, Nowosad, and Muenchow 2019, Chapter 12). Such desire lines are represented in the desire line object, loaded in Section 10.1, which were generated for the Propensity to Cycle Tool project (see www.pct.bike). Although the desire lines represent travel, they clearly are not the routes that people take from home to work (the dataset comes from the 2011 Census question on travel to work). People do not travel in straight lines; only birds can do that (hence the phrase ‘as the crow flies’ to denote straight line distance). People take a range of routes from A to B. Therefore, the distance of cycleway inside a buffer surrounding a desire line may be a better indication of the accessibility of cycle infrastructure for everyday travel than the previous measures. The first step is to subset the desire lines so that only those within the Leeds LSOA object are included. You can do this as follows: Again, select the Select by location tool, as you did previously to select the LSOA zones that had some cycle infrastructure. This time select features in the desire lines that are Within the zones. Bonus: what is the difference when you select different types of geometric predicates (see Figure 10.5)? Figure 10.5: Select by location popup, to subset only desire lines within Leeds After you have saved a subset of the desire lines, it’s time to calculate buffers. You will create buffers of 500m (feel free to experiment with different buffer sizes after you have generated the desired result). Your growing knowledge of QGIS (and ability to search for help online if you get stuck) should help you do the next step without detailed instructions (hint: it’s also found in the Vector menu). The final step in the process is to calculate the length of cycle infrastructure in each buffer. Again, you must look this up (hint: the algorithm is called ‘Sum line lengths’). After running this algorithm on the correct inputs, and colouring the result according to the length of infrastructure in each polygon, the map should resemble Figure 10.6. Figure 10.6: Buffered lines, coloured by the length of infrastructure within each one. Given what you know about Leeds, are these the desire lines you’d expect to be well-served by cycle infrastructure? Explore the data in the Propensity to Cycle Tool (PCT) for Leeds and decide where you think new infrastructure could go (see www.pct.bike/m/?r=west-yorkshire and Figure 10.7). What additional steps could you take with QGIS to improve the accessibility metric shown in Figure 10.6? The next tasks are bonus extras. Select one of the following (or more if you are fast!): Bonus 1: Download the fast and quiet route data from the PCT’s Region Data tab and load it into QGIS (see the top of Figure 10.7 for the Region data tab). Bonus 2: is there a positive correlation between cycling levels and the length of cycle infrastructure in the buffer of each desire line? Bonus 3: explore and download the PCT data for schools here. With reference to an academic paper on the subject (Goodman et al. 2019), how could you use the data to generate a ‘Sustainable Travel to School Accessibility Measure’ (STSAM)? Figure 10.7: The propensity to cycle tool (PCT), showing data for fast and quiet routes, and demonstrating the Region dat’ tab. Go to www.pct.bike to explore the data. 10.5 Plugins An important aspect of open source software is the wider community, which often supports a diverse range of extensions which add features to the original program. QGIS is no exception: it has a thriving community of programmers who, together, have created dozens of ‘plugins’, which enhance QGIS’s capabilities in countless ways. At the time of writing, there are 200+ plugins available for QGIS 3, and this number is continuously rising. To install a plugin, click on Plugins in the Menu Bar (or press Alt+P). You should see the following options. Select the second option (Manage and Install Plugins, see Figure 10.8 (left)). You should see a new window, like the one displayed in Figure 10.8 (right). Figure 10.8: Plugins menu (left) and the resulting window (right). To install a plugin, click on the ‘Install plugin’ button in the bottom right corner of Figure 10.8 (right). Use the search bar to explore for plugins. What happens if you search for ‘trans’, for example (short for transport)? Exercise: install the QuickMapServices plugin and use it to put a basemap showing Leeds in the Map View. Hint: after you have installed the plugin navigate to the Web menu (or press Alt+W). 10.6 Advanced exercises (optional) Install the ORS Tools Plugin Signup for an API token at openrouteservice.org Add token to ORS Tools Settings Download the locations of schools from https://overpass-turbo.eu/ Buffer schools and find population within 1km of a school Make isochrone for 10, 20, 30 min cycle from schools Dissolve isochrone together may need to change rendering order (properties -&gt; symbology -&gt; layer rendering) use geoprocessing v.clean (with clean type break) edit polygons to remove the unneeded sections join the isochrones onto the points 10.7 Summary This chapter involved downloading and importing more data related to travel behaviour and cycle infrastructure. Three simple of indices of accessibility to cycle infrastructure were developed: Whether any cycle infrastructure was provided Distance from zone centroids to the nearest cycleway Length of cycle infrastructure within a given buffer distance of desire lines The skills could be used to measure accessibility to different services, including schools, shops and healthcare. "],
["data-sources-for-transport-data.html", "11 Data sources for transport data 11.1 Useful data sources 11.2 Online lists 11.3 Data packages", " 11 Data sources for transport data There are many good transport datasets out there, but they are not always easy to find. 11.1 Useful data sources The list below provides links to some key data sources that may be of use and interest, starting with the most universal and easy to use, and ending in rather specific datasets. UK geoportal, providing geographic data at many levels: https://geoportal.statistics.gov.uk Other national geoportals exist, such as this: http://www.geoportal.org/ A good source of cleaned origin destination data is the Region downloads tab in the Propensity to Cycle Tool (Lovelace et al. 2017) - see the Region data tab for West Yorkshire here, for example: http://www.pct.bike/m/?r=west-yorkshire OpenStreetMap is an excellent source of geographic data with global coverage. You can download data on specific queries (e.g. highway=cycleway) from the overpass-turbo service: https://overpass-turbo.eu/ 11.1.1 UK specific resources Students can register with Edina Digimap. It is a service which will allow you to download UK topographic map data. https://digimap.edina.ac.uk/webhelp/digimapsupport/about.htm#access/access_to_digimap.htm UK census data can be accessed from several places including: https://census.edina.ac.uk/bds.html https://www.nomisweb.co.uk/census/2011 11.1.2 International resources http://freegisdata.rtwilson.com/ Note this has a listing of several transport data sources http://www.gadm.org/ boundary datasets for administrative areas around the world. https://www.gislounge.com/world-gis-data/ links to further resources http://wiki.openstreetmap.org/wiki/Downloading_data information about downloading Open streetmap (OSM) data. https://library.stanford.edu/research/stanford-geospatial-center/data Stanford University directory of data sources http://www.diva-gis.org/gdata available datasets by country. (availability of these resources may change) 11.2 Online lists For other datasets, search online! Good starting points in your research may be: The open data section in Lovelace, Nowosad, and Muenchow (2019) - https://geocompr.robinlovelace.net/read-write.html#retrieving-data Transport datasets mentioned here: https://data.world/datasets/transportation UK government transport data: https://ckan.publishing.service.gov.uk/publisher/department-for-transport 11.3 Data packages The ors and OSMTools QGIS plugins provide a range of datasets The stats19 package can get road crash data for anywhere in Great Britain (Lovelace et al. 2019) see here for info: https://itsleeds.github.io/stats19/ The pct package provides access to data in the PCT: https://github.com/ITSLeeds/pct There are many other QGIS and R packages and plugins to help access data "],
["further-reading.html", "12 Further reading 12.1 Learning how to use QGIS 12.2 GIS text books (covering principles of GIS) 12.3 Open online resources 12.4 How to install QGIS on your own computer", " 12 Further reading 12.1 Learning how to use QGIS This is a recent self learn text. Menke,K. (2019)Discover QGIS 3.x: A Workbook for Classroom or Independent Study (Paperback) Locate Press ISBN: 9780998547763 QGIS also has a very detailed web-based user-manual. http://docs.qgis.org/2.2/en/docs/user_manual/index.html Other books of interest Graser, A., 2016. Learning QGIS - Third Edition, 3rd Revised edition edition. ed. Packt Publishing. Taylor, M.M., Freeman, N., 2014. Getting Started With GIS Using QGIS, 1 edition. ed. CreateSpace Independent Publishing Platform. 12.2 GIS text books (covering principles of GIS) Ferrari, E., Rae, A, (2019). GIS for Planning and the Built Environment. MacMillan ISBN: 9781137307149 Heywood, D.I., Cornelius, M.S., Carver, D.S., 2011. An Introduction to Geographical Information Systems, 4 edition. ed. Prentice Hall, Harlow, England ; Toronto. Longley, P.A., Goodchild, M.F., Maguire, D.J., Rhind, D.W., 2015. Geographic Information Science and Systems, 4th Revised edition edition. ed. John Wiley &amp; Sons, Hoboken, NJ. 12.3 Open online resources Further information on GIS concepts Geographic Information System Basics : http://2012books.lardbucket.org/books/geographic-information-system-basics/index.html Further information on GIS and transport http://www.geos.ed.ac.uk/~gisteac/gis_book_abridged/files/ch59.pdf 12.4 How to install QGIS on your own computer The simplest way to install QGIS is from download.qgis.org/. Here you can download for windows Mac and other operating systems. Initially, we recommend the option headed “Long term release repository (most stable):”. There are other ways to download QGIS for windows for example from OSGeo4W package, which includes additional features which you might not need straight away but which may become useful later. "],
["references.html", "References", " References "]
]
