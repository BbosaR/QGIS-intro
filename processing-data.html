<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 5 Processing data | QGIS for Transport Research: an introduction</title>
  <meta name="description" content="A book on using open source Geographic Information System for transport planning.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 5 Processing data | QGIS for Transport Research: an introduction" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A book on using open source Geographic Information System for transport planning." />
  <meta name="github-repo" content="ITSLeeds/QGIS-intro" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Processing data | QGIS for Transport Research: an introduction" />
  
  <meta name="twitter:description" content="A book on using open source Geographic Information System for transport planning." />
  

<meta name="author" content="Robin Lovelace and Malcolm Morgan">


<meta name="date" content="2019-03-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="style-and-select-features.html">
<link rel="next" href="making-maps.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">QGIS for Transport</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pre-requisites"><i class="fa fa-check"></i>Pre-requisites</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-gis"><i class="fa fa-check"></i><b>1.1</b> What is GIS?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-is-qgis"><i class="fa fa-check"></i><b>1.2</b> What is QGIS?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="working-with-qgis.html"><a href="working-with-qgis.html"><i class="fa fa-check"></i><b>2</b> Working with QGIS</a><ul>
<li class="chapter" data-level="2.1" data-path="working-with-qgis.html"><a href="working-with-qgis.html#opening-qgis"><i class="fa fa-check"></i><b>2.1</b> Opening QGIS</a></li>
<li class="chapter" data-level="2.2" data-path="working-with-qgis.html"><a href="working-with-qgis.html#key-qgis-components"><i class="fa fa-check"></i><b>2.2</b> Key QGIS components</a></li>
<li class="chapter" data-level="2.3" data-path="working-with-qgis.html"><a href="working-with-qgis.html#plugins"><i class="fa fa-check"></i><b>2.3</b> Plugins</a></li>
<li class="chapter" data-level="2.4" data-path="working-with-qgis.html"><a href="working-with-qgis.html#loading-basemaps"><i class="fa fa-check"></i><b>2.4</b> Loading basemaps</a></li>
<li class="chapter" data-level="2.5" data-path="working-with-qgis.html"><a href="working-with-qgis.html#panning-and-zooming"><i class="fa fa-check"></i><b>2.5</b> Panning and Zooming</a></li>
<li class="chapter" data-level="2.6" data-path="working-with-qgis.html"><a href="working-with-qgis.html#projects-and-files"><i class="fa fa-check"></i><b>2.6</b> Projects and Files</a></li>
<li class="chapter" data-level="2.7" data-path="working-with-qgis.html"><a href="working-with-qgis.html#projections-and-coordinate-reference-systems"><i class="fa fa-check"></i><b>2.7</b> Projections and Coordinate Reference Systems</a></li>
<li class="chapter" data-level="2.8" data-path="working-with-qgis.html"><a href="working-with-qgis.html#summary"><i class="fa fa-check"></i><b>2.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Downloading and loading data</a><ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#importing-spatial-data"><i class="fa fa-check"></i><b>3.1</b> Importing spatial data</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#importing-a-csv-or-text-file"><i class="fa fa-check"></i><b>3.2</b> Importing a CSV or text file</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data.html"><a href="data.html#csv-with-spatial-data"><i class="fa fa-check"></i><b>3.2.1</b> CSV with spatial data</a></li>
<li class="chapter" data-level="3.2.2" data-path="data.html"><a href="data.html#csv-without-spatial-data"><i class="fa fa-check"></i><b>3.2.2</b> CSV without spatial data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#summary-1"><i class="fa fa-check"></i><b>3.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="style-and-select-features.html"><a href="style-and-select-features.html"><i class="fa fa-check"></i><b>4</b> Style and select features</a><ul>
<li class="chapter" data-level="4.1" data-path="style-and-select-features.html"><a href="style-and-select-features.html#identify-features"><i class="fa fa-check"></i><b>4.1</b> Identify Features</a></li>
<li class="chapter" data-level="4.2" data-path="style-and-select-features.html"><a href="style-and-select-features.html#symbology"><i class="fa fa-check"></i><b>4.2</b> Symbology</a></li>
<li class="chapter" data-level="4.3" data-path="style-and-select-features.html"><a href="style-and-select-features.html#summary-2"><i class="fa fa-check"></i><b>4.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="processing-data.html"><a href="processing-data.html"><i class="fa fa-check"></i><b>5</b> Processing data</a><ul>
<li class="chapter" data-level="5.1" data-path="processing-data.html"><a href="processing-data.html#reprojecting-data"><i class="fa fa-check"></i><b>5.1</b> Reprojecting Data</a></li>
<li class="chapter" data-level="5.2" data-path="processing-data.html"><a href="processing-data.html#joining-data"><i class="fa fa-check"></i><b>5.2</b> Joining Data</a><ul>
<li class="chapter" data-level="5.2.1" data-path="processing-data.html"><a href="processing-data.html#attribute-joins"><i class="fa fa-check"></i><b>5.2.1</b> Attribute Joins</a></li>
<li class="chapter" data-level="5.2.2" data-path="processing-data.html"><a href="processing-data.html#spatial-joins"><i class="fa fa-check"></i><b>5.2.2</b> Spatial Joins</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="processing-data.html"><a href="processing-data.html#points-in-polygons"><i class="fa fa-check"></i><b>5.3</b> Points in Polygons</a></li>
<li class="chapter" data-level="5.4" data-path="processing-data.html"><a href="processing-data.html#summary-3"><i class="fa fa-check"></i><b>5.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="making-maps.html"><a href="making-maps.html"><i class="fa fa-check"></i><b>6</b> Making maps</a></li>
<li class="chapter" data-level="7" data-path="next-steps.html"><a href="next-steps.html"><i class="fa fa-check"></i><b>7</b> Next steps</a></li>
<li class="chapter" data-level="8" data-path="more-features.html"><a href="more-features.html"><i class="fa fa-check"></i><b>8</b> More Features</a><ul>
<li class="chapter" data-level="8.1" data-path="more-features.html"><a href="more-features.html#attribute-calculations"><i class="fa fa-check"></i><b>8.1</b> Attribute calculations</a></li>
<li class="chapter" data-level="8.2" data-path="more-features.html"><a href="more-features.html#spatial-subsetting"><i class="fa fa-check"></i><b>8.2</b> Spatial subsetting</a></li>
<li class="chapter" data-level="8.3" data-path="more-features.html"><a href="more-features.html#geoprocessing-tool-box"><i class="fa fa-check"></i><b>8.3</b> Geoprocessing Tool Box</a></li>
<li class="chapter" data-level="8.4" data-path="more-features.html"><a href="more-features.html#summary-4"><i class="fa fa-check"></i><b>8.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">QGIS for Transport Research: an introduction</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="processing-data" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Processing data</h1>
<p>We saw in Chapter … how to style and select features of interest from layers loaded into QGIS.
In this section, we will learn how to process data.
That means creating new data from existing data.</p>
<div id="reprojecting-data" class="section level2">
<h2><span class="header-section-number">5.1</span> Reprojecting Data</h2>
<p>Our two spatial datasets have different coordinate systems. This can make it difficult to make connections between the datasets. So we will reproject the stats19 data to the British National Grid.</p>
<p>In the vector, menu select Data management Tools, Reproject Layer</p>
<div class="figure"><span id="fig:reproject-menu"></span>
<img src="figures/reproject.png" alt="Reproject Menu" width="100%" />
<p class="caption">
FIGURE 5.1: Reproject Menu
</p>
</div>
<div class="figure"><span id="fig:crs-menu"></span>
<img src="figures/crs.png" alt="Reproject MenuCordiante Reference System" width="100%" />
<p class="caption">
FIGURE 5.2: Reproject MenuCordiante Reference System
</p>
</div>
</div>
<div id="joining-data" class="section level2">
<h2><span class="header-section-number">5.2</span> Joining Data</h2>
<p>Joining data allows you to link two separate datasets together by something they have in common. There are two types of join. Attribute joins (often just called joins) link two datasets by a common attribute such as an ID number. Spatial joins link dataset by a shared location.</p>
<p>In this next section, we will use a series of joins to find the area of Leeds with the highest rate of road collisions.</p>
<div id="attribute-joins" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Attribute Joins</h3>
<p>We will join the population data onto the LSOA boundaries.</p>
<p>Find “leeds_lsoa” in the Layers panel and right-click to bring up the context menu</p>
<p>Click on Properties</p>
<p>Select Joins from the options on the left</p>
<p>Click the green + button to open the Add Vector Join window</p>
<p>Select the following options:</p>
<pre><code>Join layer: population

Join field: area

Target field: lsoa11cd</code></pre>
<p>Click OK,</p>
<p>Click OK again</p>
<div class="figure"><span id="fig:joins"></span>
<img src="figures/joins.jpg" alt="The Add Vector Join window" width="100%" />
<p class="caption">
FIGURE 5.3: The Add Vector Join window
</p>
</div>
<p>Use the “Identify features” tool to see that each LSOA now has a population value.</p>
</div>
<div id="spatial-joins" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Spatial Joins</h3>
<p>We will assign an LSOA ID number to each road collision by doing a spatial join.<br />
In the “Vector” menu, select “Data Management Tools”, then “Join Attributes by Location”.</p>
<div class="figure"><span id="fig:joins-menu"></span>
<img src="figures/spatial_joins.jpg" alt="Join Attributes by Location" width="100%" />
<p class="caption">
FIGURE 5.4: Join Attributes by Location
</p>
</div>
<p>In the Vector Menu, select Data Management Tools, Select Attributes by location, as shown in <a href="processing-data.html#fig:joins-window">5.5</a>.</p>
<div class="figure"><span id="fig:joins-window"></span>
<img src="figures/spatial_joins_window.jpg" alt="Join Attributes by Location Window" width="100%" />
<p class="caption">
FIGURE 5.5: Join Attributes by Location Window
</p>
</div>
<p>For the Input Layer select “stats19” and for the output later select “leeds_lsoa”. For join type select “Create separate feature of each located feature”. Then click run.</p>
<div class="figure"><span id="fig:joins-result"></span>
<img src="figures/spatial_join_result.jpg" alt="Join Results" width="100%" />
<p class="caption">
FIGURE 5.6: Join Results
</p>
</div>
<p>Once the process has completed a new layer will have been added to the map called “joined Layer” you can use the “Identify features” tool to see that each point in the stas19 data now has the</p>
</div>
</div>
<div id="points-in-polygons" class="section level2">
<h2><span class="header-section-number">5.3</span> Points in Polygons</h2>
<p>The final step for this chapter will be to count the number of road crash casualties in each LSOA.</p>
<p>In the Vector Menu, select Analysis Tools, Count Points in Polygons.</p>
<div class="figure"><span id="fig:points-polygons"></span>
<img src="figures/points_ins_polygon.jpg" alt="Points in Polygons Tool" width="100%" />
<p class="caption">
FIGURE 5.7: Points in Polygons Tool
</p>
</div>
<p>For the Polygons choose your LSOA areas and the points the stats19 data. USe the number of casualties as a weighting field, and give the “count field name” an appropriate name.</p>
<p>A new layer will be created with the number of casualties for each LSOA. USe Symbology to visualise the most dangerous areas of Leeds.</p>
<div class="figure"><span id="fig:final-plot"></span>
<img src="figures/final_plot.jpg" alt="Number of road crash casualties in Leeds" width="100%" />
<p class="caption">
FIGURE 5.8: Number of road crash casualties in Leeds
</p>
</div>
<!-- ## Attribute calculations -->
<!-- New attributes can be added to datasets with the Calculator... -->
<!-- ## Buffers -->
<!-- ## Spatial subsetting -->
</div>
<div id="summary-3" class="section level2">
<h2><span class="header-section-number">5.4</span> Summary</h2>
<p>Before moving onto the next chapter make sure you have.</p>
<ol style="list-style-type: decimal">
<li>Reprojected the stats19 data to the British National Grid</li>
<li>Done an attribute join of the population data to the LSOA areas</li>
<li>Done a spatial join of the LSOA areas to the stats19 points</li>
<li>Counted the number of casualties in each LSOA</li>
</ol>
<p>Bonus Exercises</p>
<ol style="list-style-type: decimal">
<li>Can you use symbology to show the population of each LSOA?</li>
<li>Can you use symbology to show the number of casualties in each LSOA?</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="style-and-select-features.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="making-maps.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ITSLeeds/QGIS-intro/edit/master/05-processing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": {},
"toc": {
"collapse": "none"
}
});
});
</script>

</body>

</html>
